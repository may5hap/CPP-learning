#include<fcntl.h>           //for open()
#include<iostream>          
#include<errno.h>           //for errno
#include<string.h>          //for strerror()
#include<unistd.h>          //for close()


using namespace std;

int main(){
    int fd1, fd2;
    //fd = open("./test.txt", O_RDONLY);  // two parameters
    fd1 = open("./test.txt", O_RDONLY | O_CREAT | O_TRUNC, 0777); 
    //three parameters. the last parameter defines the mode, rwx
    //note that 0777, 0 represent 0x, 777 represent rwxrwxrwx
    //but the real file's mode is 777 & ~umask
    //umask can be seen in terminal by "umask":
    // $ umask
    // $ 0002

    cout<< "fd1 = " << fd1 << endl;
    cout<< "errno = " << errno <<endl;
    cout<< strerror(errno) << endl;
    cout<< close(fd1) << endl;       //close() will return 0 for success, -1 for fail
    
    fd2 = open("./TEST",O_RDONLY);
    cout<< "fd2 = " << fd2 << endl;
    cout<< "errno = " << errno <<endl;
    cout<< strerror(errno) << endl;
    cout<< close(fd2) << endl;
    return 0;
}